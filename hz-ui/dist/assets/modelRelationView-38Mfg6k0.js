import{_ as U,v as T,g as q,j as A,x as J,r as G,a as H,z as K,h as s,c as f,o as c,b as y,f as e,w as o,q as p,t as h,F as B,i as M,B as R,m as $,cg as Q,cd as W,c4 as X,b_ as V}from"./index-CWdEKdsq.js";import{m as Y}from"./model-doa-3kv_.js";const Z={class:"card divVertical"},ee={class:"table-header"},te={class:"header-button-lf"},ae={class:"card table-main",style:{width:"100%"}},oe={__name:"modelRelationView",setup(ne){const u=Y();T(()=>u.modelOptions);const b=T(()=>u.modelObjectById),{proxy:w}=q(),v=A(),C=J(),x=G([]),l=H({currentPage:1,pageSize:10,total:null}),j=t=>({directed:"有向图",undirected:"无向图",daggered:"有向无环图"})[t]||t,D=t=>({directed:"danger",undirected:"success",daggered:"warning"})[t]||"info",P=t=>{v.push({path:C.path+"/"+t.id})},E=()=>{v.push({path:C.path+"/new"})},I=t=>{X.confirm(`确认删除关系 "${t.name}" 吗？此操作不可恢复！`,"警告",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(async()=>{let n=await w.$api.deleteModelRelationDefine(t.id);n.status==204?(V.success("删除成功"),z()):V.error(`删除失败: ${JSON.stringify(n.data)}`)}).catch(()=>{})},N=t=>{l.pageSize=t},O=t=>{l.currentPage=t},z=async()=>{const t=await w.$api.getModelRelationDefine();x.value=t.data.results,l.total=t.data.count};return K(()=>{u.getModel(),z()}),(t,n)=>{const _=s("el-button"),r=s("el-table-column"),g=s("el-tag"),k=s("el-space"),S=s("el-tooltip"),L=s("el-table"),F=s("el-pagination");return c(),f("div",Z,[y("div",ee,[y("div",te,[e(_,{type:"primary",onClick:E},{default:o(()=>[...n[2]||(n[2]=[p("新增关系",-1)])]),_:1})])]),y("div",ae,[e(L,{data:x.value,stripe:"",style:{width:"100%"},height:"100%"},{default:o(()=>[e(r,{prop:"name",label:"关系名称",width:"200"}),e(r,{prop:"topology_type",label:"拓扑类型",width:"150"},{default:o(a=>[e(g,{type:D(a.row.topology_type)},{default:o(()=>[p(h(j(a.row.topology_type)),1)]),_:2},1032,["type"])]),_:1}),e(r,{prop:"source_model",label:"源模型",width:"300"},{default:o(a=>[e(k,{wrap:"",size:10},{default:o(()=>[(c(!0),f(B,null,M(a.row.source_model,(i,m)=>(c(),R(g,{key:m},{default:o(()=>{var d;return[p(h((d=b.value[i])==null?void 0:d.verbose_name),1)]}),_:2},1024))),128))]),_:2},1024)]),_:1}),e(r,{prop:"target_model",label:"目标模型",width:"300"},{default:o(a=>[e(k,{wrap:"",size:10},{default:o(()=>[(c(!0),f(B,null,M(a.row.target_model,(i,m)=>(c(),R(g,{key:m},{default:o(()=>{var d;return[p(h((d=b.value[i])==null?void 0:d.verbose_name),1)]}),_:2},1024))),128))]),_:2},1024)]),_:1}),e(r,{prop:"forward_verb",label:"正向动词",width:"200"}),e(r,{prop:"reverse_verb",label:"反向动词",width:"200"}),e(r,{prop:"description",label:"描述","min-width":"200"}),e(r,{label:"操作",width:"150",fixed:"right"},{default:o(a=>[e(S,{content:"查看详情",placement:"top"},{default:o(()=>[e(_,{onClick:i=>P(a.row),type:"primary",link:"",icon:$(Q)},null,8,["onClick","icon"])]),_:2},1024),e(S,{content:a.row.built_in?"内置关联关系，无法删除!":"删除关联关系",placement:"top"},{default:o(()=>[e(_,{type:"danger",link:"",icon:$(W),disabled:a.row.built_in,onClick:i=>I(a.row)},null,8,["icon","disabled","onClick"])]),_:2},1032,["content"])]),_:1})]),_:1},8,["data"]),e(F,{"current-page":l.currentPage,"onUpdate:currentPage":n[0]||(n[0]=a=>l.currentPage=a),"page-size":l.pageSize,"onUpdate:pageSize":n[1]||(n[1]=a=>l.pageSize=a),"page-sizes":[10,20,50,100],total:l.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:N,onCurrentChange:O,style:{"margin-top":"20px","justify-content":"flex-end",display:"flex"}},null,8,["current-page","page-size","total"])])])}}},se=U(oe,[["__scopeId","data-v-0b174032"]]);export{se as default};
