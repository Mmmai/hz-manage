<<<<<<<< HEAD:hz-ui/dist/assets/testView-BQwRXbVQ.js
import{d as A,g as B,y as F,r as o,z as I,A as M,h as m,c as i,o as p,f as t,w as a,q as u,F as N,i as T,t as S,b as U,cF as x}from"./index-Cm0tF2Sj.js";import{A as D}from"./ansi_up-SVqyao32.js";const H={class:"card"},z=["innerHTML"],P=A({__name:"testView",setup(R){const{proxy:j}=B();F();const g=o([]),b=o("sseTest"),v=o(null),r=o(null),E=()=>{r.value=new EventSource(v.value),r.value.onmessage=l=>{console.log(l),console.log(typeof l.data),console.log(l.data.status),g.value.push(JSON.parse(l.data)),JSON.parse(l.data).status==="SUCCESS"&&r.value.close()}},J=()=>{r.value.close()};I(()=>{});const f=o(null),L=async()=>{let l=await x.request({url:"/api/v1/test_celery/",method:"post"});f.value=l.data.task_id},w=o(null),O=async l=>{let e=await x.request({url:`/api/v1/check_task/${l}/`});w.value=e.data};M(()=>{r.value&&r.value.close(),n.value&&n.value.close()});const V=new D,_=o(""),n=o(null),c=o([]),W=()=>{c.value=[],n.value=new WebSocket("/ws/ansible/"),n.value.onmessage=l=>{const e=JSON.parse(l.data);e.type==="output"?(console.log(V.ansi_to_html(e.message+`\r
========
import{d as A,g as B,y as F,r as o,z as I,A as M,h as m,c as i,o as p,f as t,w as a,q as u,F as N,i as T,t as S,b as U,cF as x}from"./index-D37lWo2y.js";import{A as D}from"./ansi_up-SVqyao32.js";const H={class:"card"},z=["innerHTML"],P=A({__name:"testView",setup(R){const{proxy:j}=B();F();const g=o([]),b=o("sseTest"),v=o(null),r=o(null),E=()=>{r.value=new EventSource(v.value),r.value.onmessage=l=>{console.log(l),console.log(typeof l.data),console.log(l.data.status),g.value.push(JSON.parse(l.data)),JSON.parse(l.data).status==="SUCCESS"&&r.value.close()}},J=()=>{r.value.close()};I(()=>{});const f=o(null),L=async()=>{let l=await x.request({url:"/api/v1/test_celery/",method:"post"});f.value=l.data.task_id},w=o(null),O=async l=>{let e=await x.request({url:`/api/v1/check_task/${l}/`});w.value=e.data};M(()=>{r.value&&r.value.close(),n.value&&n.value.close()});const V=new D,_=o(""),n=o(null),c=o([]),W=()=>{c.value=[],n.value=new WebSocket("/ws/ansible/"),n.value.onmessage=l=>{const e=JSON.parse(l.data);e.type==="output"?(console.log(V.ansi_to_html(e.message+`\r
>>>>>>>> hz-manager/cmdb_permission:hz-ui/dist/assets/testView-BvVXDb3l.js
`)),c.value.push(V.ansi_to_html(e.message+`\r
`))):e.type==="complete"&&(console.log(e),c.value.push(`执行完成，返回码: ${e.returncode}`),n.value.close())},n.value.onopen=()=>{n.value.send(JSON.stringify({module_args:_.value,module_name:"shell",inventory:["192.168.163.160","192.168.163.162"],username:"root",password:"thinker"}))}},$=()=>{n.value.close()};return(l,e)=>{const C=m("el-input"),d=m("el-button"),k=m("el-tab-pane"),q=m("el-tabs");return p(),i("div",H,[t(q,{modelValue:b.value,"onUpdate:modelValue":e[3]||(e[3]=s=>b.value=s),class:"demo-tabs"},{default:a(()=>[t(k,{label:"SSE测试",name:"sseTest"},{default:a(()=>[t(C,{modelValue:v.value,"onUpdate:modelValue":e[0]||(e[0]=s=>v.value=s),style:{width:"480px"},placeholder:"输入sse接口地址"},null,8,["modelValue"]),t(d,{onClick:E},{default:a(()=>[...e[4]||(e[4]=[u("开始",-1)])]),_:1}),t(d,{type:"danger",onClick:J},{default:a(()=>[...e[5]||(e[5]=[u("终止",-1)])]),_:1}),(p(!0),i(N,null,T(g.value,(s,y)=>(p(),i("p",{key:y},S(s),1))),128))]),_:1}),t(k,{label:"celery测试",name:"celery"},{default:a(()=>[t(d,{onClick:L},{default:a(()=>[...e[6]||(e[6]=[u("提交任务",-1)])]),_:1}),t(d,{type:"primary",onClick:e[1]||(e[1]=s=>O(f.value))},{default:a(()=>[...e[7]||(e[7]=[u("查看任务状态",-1)])]),_:1}),u(" "+S(`任务ID是：${f.value}`)+" ",1),U("div",null,S(w.value),1)]),_:1}),t(k,{label:"WebSocket测试",name:"weSocketTest"},{default:a(()=>[t(C,{modelValue:_.value,"onUpdate:modelValue":e[2]||(e[2]=s=>_.value=s),style:{width:"240px"}},null,8,["modelValue"]),t(d,{onClick:W},{default:a(()=>[...e[8]||(e[8]=[u("执行",-1)])]),_:1}),t(d,{type:"danger",onClick:$},{default:a(()=>[...e[9]||(e[9]=[u("终止",-1)])]),_:1}),(p(!0),i(N,null,T(c.value,(s,y)=>(p(),i("div",{key:y},[U("div",{innerHTML:s},null,8,z)]))),128))]),_:1})]),_:1},8,["modelValue"])])}}});export{P as default};
