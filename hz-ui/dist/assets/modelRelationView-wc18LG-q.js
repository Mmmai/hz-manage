import{_ as U,l as M,g as A,bK as J,f as K,h as Y,r as S,a as G,m as H,e as d,c as b,o as c,i as y,b as e,w as o,k as u,t as h,F as j,p as B,q,y as R,cf as Q,c7 as W,bY as X,c3 as $}from"./index-DD1IBG_Z.js";import{m as Z}from"./model-DLhakzJz.js";const ee={class:"card divVertical"},te={class:"table-header"},ae={class:"header-button-lf"},oe={class:"card table-container",style:{width:"100%"}},re={__name:"modelRelationView",setup(ne){const _=Z();M(()=>_.modelOptions);const p=M(()=>_.modelObjectById),{proxy:v}=A();J(()=>p,()=>{console.log(p.value)},{deep:!0,immediate:!0});const w=K(),k=Y(),T=S([]);S([{id:"e307f2ad-12e6-49ac-8215-e6c29aa5f58e",name:"主机-交换机",topology_type:"directed",forward_verb:"上联",reverse_verb:"下联",attribute_schema:{source:{port:{type:"string",required:!1,verbose_name:"端口"}},target:{port:{type:"string",required:!1,verbose_name:"端口"}},relation:{speed:{type:"float",unit:"Mbps",default:"20000",required:!0,verbose_name:"速率"}}},description:null,create_time:"2025-10-31T17:42:59.661169",update_time:"2025-10-31T17:42:59.661210",create_user:"admin",update_user:"admin",source_model:"8103d7da-ede7-4416-9b77-f19a81a4d671",target_model:"1394f70d-ade6-4548-aa6a-13f9b8296b35"},{id:"a1b2c3d4-e5f6-7890-g1h2-i3j4k5l6m7n8",name:"应用-服务器",topology_type:"undirected",forward_verb:"部署于",reverse_verb:"承载",attribute_schema:{source:{},target:{},relation:{deploy_path:{type:"string",required:!1,verbose_name:"部署路径"}}},description:"应用与服务器的关系",create_time:"2025-11-01T09:15:30.123456",update_time:"2025-11-01T09:15:30.123456",create_user:"admin",update_user:"admin",source_model:"abcd1234-ef56-7890-ghij-klmn12345678",target_model:"8103d7da-ede7-4416-9b77-f19a81a4d671"},{id:"b2c3d4e5-f6g7-8901-h2i3-j4k5l6m7n8o9",name:"服务依赖",topology_type:"daggered",forward_verb:"依赖",reverse_verb:"被依赖",attribute_schema:{source:{},target:{},relation:{weight:{type:"integer",required:!1,verbose_name:"权重"}}},description:"服务间依赖关系",create_time:"2025-11-02T14:20:45.987654",update_time:"2025-11-02T14:20:45.987654",create_user:"admin",update_user:"admin",source_model:"defg5678-hijk-9012-lmno-345678901234",target_model:"ghij9012-klmn-3456-opqr-789012345678"}]);const n=G({currentPage:1,pageSize:10,total:null}),V=t=>({directed:"有向图",undirected:"无向图",daggered:"有向无环图"})[t]||t,D=t=>({directed:"danger",undirected:"success",daggered:"warning"})[t]||"info",P=t=>{w.push({path:k.path+"/"+t.id})},E=()=>{w.push({path:k.path+"/new"})},I=t=>{X.confirm(`确认删除关系 "${t.name}" 吗？此操作不可恢复！`,"警告",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(async()=>{let r=await v.$api.deleteModelRelationDefine(t.id);r.status==204?($.success("删除成功"),C()):$.error(`删除失败: ${JSON.stringify(r.data)}`)}).catch(()=>{})},N=t=>{n.pageSize=t},O=t=>{n.currentPage=t},C=async()=>{const t=await v.$api.getModelRelationDefine();T.value=t.data.results,n.total=t.data.count};return H(()=>{_.getModel(),C()}),(t,r)=>{const g=d("el-button"),l=d("el-table-column"),m=d("el-tag"),x=d("el-space"),z=d("el-tooltip"),L=d("el-table"),F=d("el-pagination");return c(),b("div",ee,[y("div",te,[y("div",ae,[e(g,{type:"primary",onClick:E},{default:o(()=>[...r[2]||(r[2]=[u("新增关系",-1)])]),_:1})])]),y("div",oe,[e(L,{data:T.value,stripe:"",style:{width:"100%"}},{default:o(()=>[e(l,{prop:"name",label:"关系名称",width:"200"}),e(l,{prop:"topology_type",label:"拓扑类型",width:"150"},{default:o(a=>[e(m,{type:D(a.row.topology_type)},{default:o(()=>[u(h(V(a.row.topology_type)),1)]),_:2},1032,["type"])]),_:1}),e(l,{prop:"source_model",label:"源模型",width:"300"},{default:o(a=>[e(x,{wrap:"",size:10},{default:o(()=>[(c(!0),b(j,null,B(a.row.source_model,(s,f)=>(c(),q(m,{key:f},{default:o(()=>{var i;return[u(h((i=p.value[s])==null?void 0:i.verbose_name),1)]}),_:2},1024))),128))]),_:2},1024)]),_:1}),e(l,{prop:"target_model",label:"目标模型",width:"300"},{default:o(a=>[e(x,{wrap:"",size:10},{default:o(()=>[(c(!0),b(j,null,B(a.row.target_model,(s,f)=>(c(),q(m,{key:f},{default:o(()=>{var i;return[u(h((i=p.value[s])==null?void 0:i.verbose_name),1)]}),_:2},1024))),128))]),_:2},1024)]),_:1}),e(l,{prop:"forward_verb",label:"正向动词",width:"200"}),e(l,{prop:"reverse_verb",label:"反向动词",width:"200"}),e(l,{prop:"description",label:"描述","min-width":"200"}),e(l,{label:"操作",width:"150",fixed:"right"},{default:o(a=>[e(z,{content:"查看详情",placement:"top"},{default:o(()=>[e(g,{onClick:s=>P(a.row),type:"primary",link:"",icon:R(Q)},null,8,["onClick","icon"])]),_:2},1024),e(z,{content:a.row.built_in?"内置关联关系，无法删除!":"删除关联关系",placement:"top"},{default:o(()=>[e(g,{type:"danger",link:"",icon:R(W),disabled:a.row.built_in,onClick:s=>I(a.row)},null,8,["icon","disabled","onClick"])]),_:2},1032,["content"])]),_:1})]),_:1},8,["data"]),e(F,{"current-page":n.currentPage,"onUpdate:currentPage":r[0]||(r[0]=a=>n.currentPage=a),"page-size":n.pageSize,"onUpdate:pageSize":r[1]||(r[1]=a=>n.pageSize=a),"page-sizes":[10,20,50,100],total:n.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:N,onCurrentChange:O,style:{"margin-top":"20px","justify-content":"flex-end",display:"flex"}},null,8,["current-page","page-size","total"])])])}}},se=U(re,[["__scopeId","data-v-bb1282c2"]]);export{se as default};
