<<<<<<<< HEAD:hz-ui/dist/assets/userGroupView-D96rbG5L.js
import{d as te,x as ae,g as oe,y as se,r as i,v as ne,a as re,j as ue,z as ie,h as r,bc as de,c as v,o as d,b as $,f as a,bV as h,m as _,B as y,w as o,q as w,F as G,i as U,t as M,cc as ce,cD as pe,cd as _e,aP as me,c4 as fe,b_ as m}from"./index-Cm0tF2Sj.js";const ge={class:"card"},be={class:"table-header"},ve={class:"header-button-lf"},ye={class:"flexJstart gap-5"},we={class:"flexJstart gap-5"},Ve=te({name:"userGroup",__name:"userGroupView",setup(ke){const k=ae(),{proxy:f}=oe();se();const R=i([]);i(!1);const c=i(!1),B=i(null),D=i([]);i("add"),ne(()=>{let l=new Object;return D.value.forEach(e=>{l[e.id]=e}),l});const s=re({group_name:"",role_ids:[],user_ids:[]}),T=l=>{l&&l.resetFields()},O=async()=>{let l=await f.$api.getRole();D.value=l.data.results},N=i([]),P=async()=>{let l=await f.$api.user();N.value=l.data.results},x=async()=>{let l=await f.$api.getUserGroup();R.value=l.data.results,console.log(R.value)},z=i(null),I=()=>{c.value=!1,T(B.value)},E=()=>{c.value=!0,g.value={}},g=i({}),b=i(!0),L=l=>{c.value=!0,g.value=l,b.value=!1,me(()=>{s.group_name=l.group_name,s.role_ids=l.roles.map(e=>e.id),s.user_ids=l.users.map(e=>e.id),console.log(s)}),console.log(s)},H=l=>{fe.confirm("是否确认删除?","删除",{confirmButtonText:"确认删除",cancelButtonText:"取消",type:"warning",draggable:!0}).then(async()=>{(await f.$api.deleteUserGroup(l)).status==204?(m({type:"success",message:"删除成功"}),await x()):m({type:"error",message:"删除失败"})}).catch(()=>{m({type:"info",message:"取消删除"})})},K=async l=>{await l.validate(async(e,p)=>{if(e)if(b.value){let u=await f.$api.addUserGroup({...s});u.status=="201"?(m({type:"success",message:"添加成功"}),c.value=!1,T(l),await x()):m({showClose:!0,message:"添加失败:"+JSON.stringify(u.data),type:"error"})}else{let u=await f.$api.updateUserGroup({id:g.value.id,...s});u.status=="200"?(m({type:"success",message:"更新成功"}),c.value=!1,T(l),await x()):m({showClose:!0,message:"更新失败:"+JSON.stringify(u.data),type:"error"})}})},Q=ue(),W=l=>{Q.push({name:"permission",query:{user_group:l.id}})};return ie(async()=>{await O(),await P(),await x()}),(l,e)=>{var q;const p=r("el-button"),u=r("el-table-column"),J=r("el-tag"),F=r("el-tooltip"),X=r("el-table"),Y=r("el-input"),V=r("el-form-item"),S=r("el-option"),j=r("el-select"),Z=r("el-row"),ee=r("el-form"),le=r("el-dialog"),C=de("permission");return d(),v("div",ge,[$("div",be,[$("div",ve,[h((d(),y(p,{type:"primary",onClick:E},{default:o(()=>[...e[5]||(e[5]=[w("添加",-1)])]),_:1})),[[C,`${(q=_(k).name)==null?void 0:q.replace("_info","")}:add`]])])]),a(X,{ref_key:"multipleTableRef",ref:z,data:R.value,style:{width:"100%"},border:""},{default:o(()=>[a(u,{property:"group_name",label:"用户组名",sortable:"custom"}),a(u,{property:"user_count",label:"关联用户数"}),a(u,{property:"users",label:"用户列表"},{default:o(t=>[$("div",ye,[(d(!0),v(G,null,U(t.row.users,n=>(d(),y(J,{key:n},{default:o(()=>[w(M(n.username),1)]),_:2},1024))),128))])]),_:1}),a(u,{property:"roles",label:"角色列表"},{default:o(t=>[$("div",we,[(d(!0),v(G,null,U(t.row.roles,n=>(d(),y(J,{key:n,type:"warning"},{default:o(()=>[w(M(n.role_name),1)]),_:2},1024))),128))])]),_:1}),a(u,{fixed:"right",width:"120",label:"操作"},{default:o(t=>[a(F,{class:"box-item",effect:"dark",content:"编辑",placement:"top"},{default:o(()=>{var n;return[h(a(p,{link:"",type:"primary",icon:_(ce),onClick:A=>L(t.row)},null,8,["icon","onClick"]),[[C,`${(n=_(k).name)==null?void 0:n.replace("_info","")}:edit`]])]}),_:2},1024),a(F,{content:"权限配置",placement:"top"},{default:o(()=>{var n;return[h(a(p,{link:"",type:"primary",icon:_(pe),onClick:A=>W(t.row)},null,8,["icon","onClick"]),[[C,`${(n=_(k).name)==null?void 0:n.replace("_info","")}:edit`]])]}),_:2},1024),a(F,{class:"box-item",effect:"dark",content:"删除",placement:"top"},{default:o(()=>{var n;return[h(a(p,{link:"",disabled:t.row.built_in,type:"danger",icon:_(_e),onClick:A=>H(t.row.id)},null,8,["disabled","icon","onClick"]),[[C,`${(n=_(k).name)==null?void 0:n.replace("_info","")}:delete`]])]}),_:2},1024)]),_:1})]),_:1},8,["data"]),a(le,{modelValue:c.value,"onUpdate:modelValue":e[4]||(e[4]=t=>c.value=t),title:b.value?"新增用户组":"编辑用户组",width:"45%","before-close":I},{default:o(()=>[a(ee,{inline:!0,model:s,class:"demo-form-inline","label-position":"right",ref_key:"userGroupFrom",ref:B,"status-icon":""},{default:o(()=>[a(V,{label:"用户组名称",prop:"group_name",rules:[{required:!0}]},{default:o(()=>[a(Y,{modelValue:s.group_name,"onUpdate:modelValue":e[0]||(e[0]=t=>s.group_name=t),placeholder:"",clearable:"",disabled:!b.value&&g.value.built_in,style:{width:"220px"}},null,8,["modelValue","disabled"])]),_:1}),a(V,{label:"关联用户",prop:"user_ids"},{default:o(()=>[a(j,{modelValue:s.user_ids,"onUpdate:modelValue":e[1]||(e[1]=t=>s.user_ids=t),placeholder:"",clearable:"",multiple:"","collapse-tags":"","collapse-tags-tooltip":"","max-collapse-tags":3,style:{width:"220px"}},{default:o(()=>[(d(!0),v(G,null,U(N.value,t=>(d(),y(S,{key:t.id,label:t.username,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(V,{label:"关联角色",prop:"role_ids"},{default:o(()=>[a(j,{modelValue:s.role_ids,"onUpdate:modelValue":e[2]||(e[2]=t=>s.role_ids=t),placeholder:"",clearable:"",multiple:"","collapse-tags":"","collapse-tags-tooltip":"","max-collapse-tags":3,disabled:!b.value&&g.value.built_in,style:{width:"220px"}},{default:o(()=>[(d(!0),v(G,null,U(D.value,t=>(d(),y(S,{key:t.id,label:t.role,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),a(Z,{style:{"justify-content":"space-around"}},{default:o(()=>[a(V,null,{default:o(()=>[a(p,{onClick:I},{default:o(()=>[...e[6]||(e[6]=[w("取消",-1)])]),_:1}),a(p,{type:"primary",onClick:e[3]||(e[3]=t=>K(B.value))},{default:o(()=>[...e[7]||(e[7]=[w(" 确定",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}});export{Ve as default};
========
import{d as te,x as ae,g as oe,y as se,r as i,v as ne,a as re,j as ue,z as ie,h as r,bc as de,c as v,o as d,b as $,f as a,bV as h,m as _,B as y,w as o,q as w,F as G,i as U,t as M,cc as ce,cD as pe,cd as _e,aP as me,c4 as fe,b_ as m}from"./index-D37lWo2y.js";const ge={class:"card"},be={class:"table-header"},ve={class:"header-button-lf"},ye={class:"flexJstart gap-5"},we={class:"flexJstart gap-5"},Ve=te({name:"userGroup",__name:"userGroupView",setup(ke){const k=ae(),{proxy:f}=oe();se();const R=i([]);i(!1);const c=i(!1),B=i(null),D=i([]);i("add"),ne(()=>{let l=new Object;return D.value.forEach(e=>{l[e.id]=e}),l});const s=re({group_name:"",role_ids:[],user_ids:[]}),T=l=>{l&&l.resetFields()},O=async()=>{let l=await f.$api.getRole();D.value=l.data.results},N=i([]),P=async()=>{let l=await f.$api.user();N.value=l.data.results},x=async()=>{let l=await f.$api.getUserGroup();R.value=l.data.results,console.log(R.value)},z=i(null),I=()=>{c.value=!1,T(B.value)},E=()=>{c.value=!0,g.value={}},g=i({}),b=i(!0),L=l=>{c.value=!0,g.value=l,b.value=!1,me(()=>{s.group_name=l.group_name,s.role_ids=l.roles.map(e=>e.id),s.user_ids=l.users.map(e=>e.id),console.log(s)}),console.log(s)},H=l=>{fe.confirm("是否确认删除?","删除",{confirmButtonText:"确认删除",cancelButtonText:"取消",type:"warning",draggable:!0}).then(async()=>{(await f.$api.deleteUserGroup(l)).status==204?(m({type:"success",message:"删除成功"}),await x()):m({type:"error",message:"删除失败"})}).catch(()=>{m({type:"info",message:"取消删除"})})},K=async l=>{await l.validate(async(e,p)=>{if(e)if(b.value){let u=await f.$api.addUserGroup({...s});u.status=="201"?(m({type:"success",message:"添加成功"}),c.value=!1,T(l),await x()):m({showClose:!0,message:"添加失败:"+JSON.stringify(u.data),type:"error"})}else{let u=await f.$api.updateUserGroup({id:g.value.id,...s});u.status=="200"?(m({type:"success",message:"更新成功"}),c.value=!1,T(l),await x()):m({showClose:!0,message:"更新失败:"+JSON.stringify(u.data),type:"error"})}})},Q=ue(),W=l=>{Q.push({name:"permission",query:{user_group:l.id}})};return ie(async()=>{await O(),await P(),await x()}),(l,e)=>{var q;const p=r("el-button"),u=r("el-table-column"),J=r("el-tag"),F=r("el-tooltip"),X=r("el-table"),Y=r("el-input"),V=r("el-form-item"),S=r("el-option"),j=r("el-select"),Z=r("el-row"),ee=r("el-form"),le=r("el-dialog"),C=de("permission");return d(),v("div",ge,[$("div",be,[$("div",ve,[h((d(),y(p,{type:"primary",onClick:E},{default:o(()=>[...e[5]||(e[5]=[w("添加",-1)])]),_:1})),[[C,`${(q=_(k).name)==null?void 0:q.replace("_info","")}:add`]])])]),a(X,{ref_key:"multipleTableRef",ref:z,data:R.value,style:{width:"100%"},border:""},{default:o(()=>[a(u,{property:"group_name",label:"用户组名",sortable:"custom"}),a(u,{property:"user_count",label:"关联用户数"}),a(u,{property:"users",label:"用户列表"},{default:o(t=>[$("div",ye,[(d(!0),v(G,null,U(t.row.users,n=>(d(),y(J,{key:n},{default:o(()=>[w(M(n.username),1)]),_:2},1024))),128))])]),_:1}),a(u,{property:"roles",label:"角色列表"},{default:o(t=>[$("div",we,[(d(!0),v(G,null,U(t.row.roles,n=>(d(),y(J,{key:n,type:"warning"},{default:o(()=>[w(M(n.role_name),1)]),_:2},1024))),128))])]),_:1}),a(u,{fixed:"right",width:"120",label:"操作"},{default:o(t=>[a(F,{class:"box-item",effect:"dark",content:"编辑",placement:"top"},{default:o(()=>{var n;return[h(a(p,{link:"",type:"primary",icon:_(ce),onClick:A=>L(t.row)},null,8,["icon","onClick"]),[[C,`${(n=_(k).name)==null?void 0:n.replace("_info","")}:edit`]])]}),_:2},1024),a(F,{content:"权限配置",placement:"top"},{default:o(()=>{var n;return[h(a(p,{link:"",type:"primary",icon:_(pe),onClick:A=>W(t.row)},null,8,["icon","onClick"]),[[C,`${(n=_(k).name)==null?void 0:n.replace("_info","")}:edit`]])]}),_:2},1024),a(F,{class:"box-item",effect:"dark",content:"删除",placement:"top"},{default:o(()=>{var n;return[h(a(p,{link:"",disabled:t.row.built_in,type:"danger",icon:_(_e),onClick:A=>H(t.row.id)},null,8,["disabled","icon","onClick"]),[[C,`${(n=_(k).name)==null?void 0:n.replace("_info","")}:delete`]])]}),_:2},1024)]),_:1})]),_:1},8,["data"]),a(le,{modelValue:c.value,"onUpdate:modelValue":e[4]||(e[4]=t=>c.value=t),title:b.value?"新增用户组":"编辑用户组",width:"45%","before-close":I},{default:o(()=>[a(ee,{inline:!0,model:s,class:"demo-form-inline","label-position":"right",ref_key:"userGroupFrom",ref:B,"status-icon":""},{default:o(()=>[a(V,{label:"用户组名称",prop:"group_name",rules:[{required:!0}]},{default:o(()=>[a(Y,{modelValue:s.group_name,"onUpdate:modelValue":e[0]||(e[0]=t=>s.group_name=t),placeholder:"",clearable:"",disabled:!b.value&&g.value.built_in,style:{width:"220px"}},null,8,["modelValue","disabled"])]),_:1}),a(V,{label:"关联用户",prop:"user_ids"},{default:o(()=>[a(j,{modelValue:s.user_ids,"onUpdate:modelValue":e[1]||(e[1]=t=>s.user_ids=t),placeholder:"",clearable:"",multiple:"","collapse-tags":"","collapse-tags-tooltip":"","max-collapse-tags":3,style:{width:"220px"}},{default:o(()=>[(d(!0),v(G,null,U(N.value,t=>(d(),y(S,{key:t.id,label:t.username,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(V,{label:"关联角色",prop:"role_ids"},{default:o(()=>[a(j,{modelValue:s.role_ids,"onUpdate:modelValue":e[2]||(e[2]=t=>s.role_ids=t),placeholder:"",clearable:"",multiple:"","collapse-tags":"","collapse-tags-tooltip":"","max-collapse-tags":3,disabled:!b.value&&g.value.built_in,style:{width:"220px"}},{default:o(()=>[(d(!0),v(G,null,U(D.value,t=>(d(),y(S,{key:t.id,label:t.role,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),a(Z,{style:{"justify-content":"space-around"}},{default:o(()=>[a(V,null,{default:o(()=>[a(p,{onClick:I},{default:o(()=>[...e[6]||(e[6]=[w("取消",-1)])]),_:1}),a(p,{type:"primary",onClick:e[3]||(e[3]=t=>K(B.value))},{default:o(()=>[...e[7]||(e[7]=[w(" 确定",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}});export{Ve as default};
>>>>>>>> hz-manager/cmdb_permission:hz-ui/dist/assets/userGroupView-BaBpENDI.js
