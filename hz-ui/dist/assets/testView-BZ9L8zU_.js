import{d as w,u as C,r as n,aN as V,aS as N,e as r,o as T,f as x,g as a,w as s,j as l,t as i,h as B,cs as f}from"./index-LFaOStT9.js";const E={class:"card"},D=w({__name:"testView",setup($){C();const c=n([]),p=n("sseTest"),o=n(null),k=()=>{o.value=new EventSource("/api/v1/log/logFlowMission/get_lokiAnalysis_status/53467f14-557f-4472-8dd8-150fdd8b4684/"),o.value.onmessage=t=>{console.log(typeof t.data),console.log(t.data.is_finish),c.value.push(t.data)}},y=()=>{o.value.close()};V(()=>{});const d=n(null),b=async()=>{let t=await f.request({url:"/api/v1/test_celery/",method:"post"});d.value=t.data.task_id},v=n(null),g=async t=>{let e=await f.request({url:`/api/v1/check_task/${t}/`});v.value=e.data};return N(()=>{o.value&&o.value.close()}),(t,e)=>{const u=r("el-button"),m=r("el-tab-pane"),S=r("el-tabs");return T(),x("div",E,[a(S,{modelValue:p.value,"onUpdate:modelValue":e[1]||(e[1]=_=>p.value=_),class:"demo-tabs"},{default:s(()=>[a(m,{label:"SSE测试",name:"sseTest"},{default:s(()=>[a(u,{onClick:k},{default:s(()=>e[2]||(e[2]=[l("开始")])),_:1}),a(u,{type:"danger",onClick:y},{default:s(()=>e[3]||(e[3]=[l("终止")])),_:1}),l(" "+i(c.value),1)]),_:1}),a(m,{label:"celery测试",name:"celery"},{default:s(()=>[a(u,{onClick:b},{default:s(()=>e[4]||(e[4]=[l("提交任务")])),_:1}),a(u,{type:"primary",onClick:e[0]||(e[0]=_=>g(d.value))},{default:s(()=>e[5]||(e[5]=[l("查看任务状态")])),_:1}),l(" "+i(`任务ID是：${d.value}`)+" ",1),B("div",null,i(v.value),1)]),_:1})]),_:1},8,["modelValue"])])}}});export{D as default};
